# yaml-language-server: $schema=https://coderabbit.ai/integrations/schema.v2.json

language: "ko-KR"
early_access: true

tone_instructions: |
  한국어(ko-KR)로 정중하고 협업적인 톤의 코드 리뷰를 제공합니다.
  비판보다는 개선 방향과 근거를 중심으로 설명하며,
  Spring Boot / JPA 기반 백엔드 설계 관점에서 리뷰합니다.
  다음 사항을 중점적으로 확인합니다:
  - Spring Boot 및 JPA 베스트 프랙티스
  - 생성자 주입 사용 여부 (필드 주입 금지)
  - 트랜잭션 경계(@Transactional)의 적절성
  - N+1 쿼리 가능성
  - Projection, fetch join, 인덱스 사용 가능성
  - 인증/인가(JWT) 보안 취약점
  - 입력값 검증 책임 분리 (API vs Service)

reviews:
  profile: "assertive"
  high_level_summary: true
  changed_files_summary: true
  review_status: true
  collapse_walkthrough: true
  abort_on_close: true

  path_filters:
    - "src/**"
    - ".github/**"
    - ".coderabbit.yaml"
    - "Dockerfile"
    - "docker-compose*.yml"
    - "build.gradle"
    - "settings.gradle"
    - "!build/**"
    - "!out/**"
    - "!.gradle/**"
    - "!gradle/wrapper/**"
    - "!gradlew"
    - "!gradlew.bat"
    - "!**/*.png"
    - "!**/*.jpg"
    - "!**/*.jpeg"
    - "!**/*.svg"
    - "!**/*.lock"
    - "!**/*.md"

  # 코드 리뷰 기준
  path_instructions:
    - path: "src/**"
      instructions: |
        [네이밍 규칙]
        - 변수/메서드: camelCase
        - 클래스/인터페이스: PascalCase
        - 패키지명: 소문자

        [레이어별 네이밍]
        - Controller: {Domain}Controller
        - API Interface(Swagger): {Domain}Api
        - Service 인터페이스: {Domain}Usecase
        - Service 구현체: {Domain}Service
        - Repository: {Domain}Repository
        - DTO: CreateXXRequest / CreateXXResponse
        - SuccessCode Enum: {Domain}SuccessCode
        - ErrorCode Enum: {Domain}ErrorCode
        - Exception: {Domain}Exception

        [메서드 네이밍]
        - Controller: create / update / get / delete
        - Service: 비즈니스 행위를 드러내는 동사 사용
        - 조회 메서드:
          * get: 단순 조회
          * find: 조건 조회
          * fetch: 외부 호출
          * load: 내부 상태 로딩
        - 상태 판단: is / has / can
        - 데이터 변경: create, save, update, delete/remove, register, replace

        [검증 책임]
        - API Layer: 형식 검증 (@Valid 등)
        - Service Layer: 비즈니스 규칙 검증
        - 중복 검증 금지
        - 위반 시 Custom BusinessException 사용

        [Spring/JPA 주의사항]
        - 필드 주입 금지 (생성자 주입)
        - 조회 전용 트랜잭션은 readOnly=true 권장
        - N+1 발생 가능성 지적
        - 성능 민감 조회는 Projection / fetch join 고려

  auto_review:
    enabled: true
    drafts: false
    base_branches:
      - "main"
      - "develop"
    labels:
      - "!wip"
      - "!draft"
      - "!skip-review"

  tools:
    gitleaks:
      enabled: true
    yamllint:
      enabled: true
    actionlint:
      enabled: true

chat:
  auto_reply: true
  art: false

knowledge_base:
  web_search:
    enabled: true
  code_guidelines:
    enabled: true

